"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("react"),r=require("../core/useProgress.cjs.js");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}require("three"),require("zustand");var a=n(e),u=i(t),o=function(e){return"Loading "+e.toFixed(2)+"%"};var c={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}};exports.Loader=function(e){var t=e.containerStyles,n=e.innerStyles,i=e.barStyles,l=e.dataStyles,s=e.dataInterpolation,f=void 0===s?o:s,d=e.initialState,m=void 0===d?function(e){return e}:d,p=r.useProgress(),b=p.active,y=p.progress,g=u.useRef(0),v=u.useRef(0),h=u.useRef(null),S=u.useState(m(b)),j=S[0],E=S[1];u.useEffect((function(){var e;return b!==j&&(e=setTimeout((function(){return E(b)}),300)),function(){return clearTimeout(e)}}),[j,b]);var x=u.useCallback((function(){h.current&&(g.current+=(y-g.current)/2,(g.current>.95*y||100===y)&&(g.current=y),h.current.innerText=f(g.current),g.current<y&&(v.current=requestAnimationFrame(x)))}),[f,y]);return u.useEffect((function(){return x(),function(){return cancelAnimationFrame(v.current)}}),[x]),j?u.createElement("div",{style:a.default({},c.container,{opacity:b?1:0},t)},u.createElement("div",null,u.createElement("div",{style:a.default({},c.inner,n)},u.createElement("div",{style:a.default({},c.bar,{transform:"scaleX("+y/100+")"},i)}),u.createElement("span",{ref:h,style:a.default({},c.data,l)})))):null};
