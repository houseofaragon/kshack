"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("@react-three/fiber"),n=require("three"),t=require("three-stdlib"),u=require("use-asset"),o=require("../helpers/environment-assets.cjs.js");function i(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var t=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,t.get?t:{enumerable:!0,get:function(){return e[n]}})}})),r.default=e,Object.freeze(r)}var s=i(e);exports.Environment=function(e){var i=e.background,a=void 0!==i&&i,c=e.files,d=void 0===c?["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"]:c,f=e.path,p=void 0===f?"":f,b=e.preset,v=void 0===b?void 0:b,g=e.scene,l=e.extensions;if(v){if(!(v in o.presetsObj))throw new Error("Preset must be one of: "+Object.keys(o.presetsObj).join(", "));d=o.presetsObj[v],p="https://rawcdn.githack.com/pmndrs/drei-assets/aa3600359ba664d546d05821bcbca42013587df2/hdri/"}var m=r.useThree((function(e){return e.scene})),h=r.useThree((function(e){return e.gl})),j=Array.isArray(d),O=j?n.CubeTextureLoader:t.RGBELoader,k=r.useLoader(O,j?[d]:d,(function(e){e.setPath(p),l&&l(e)})),y=j?k[0]:k,q=u.useAsset((function(){return new Promise((function(e){var r=new n.PMREMGenerator(h),t=function(e,r,n){return n?(r.compileEquirectangularShader(),r.fromCubemap(e).texture):r.fromEquirectangular(e).texture}(y,r,j);r.dispose(),e(t)}))}),y);return s.useLayoutEffect((function(){var e=g?g.background:m.background,r=g?g.environment:m.environment;return g?(g.environment=q,a&&(g.background=q)):(m.environment=q,a&&(m.background=q)),function(){g?(g.environment=r,g.background=e):(m.environment=r,m.background=e),u.useAsset.clear(y),q.dispose()}}),[q,a,g]),null};
