"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),t=require("react"),a=require("three"),n=require("@react-three/fiber"),u=require("three-stdlib");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var a=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,a.get?a:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}var l=i(e),d=i(r),f=o(t),c=o(a),s=f.forwardRef((function(e,r){var t=e.opacity,a=void 0===t?1:t,i=e.width,o=void 0===i?1:i,s=e.height,h=void 0===s?1:s,p=e.blur,m=void 0===p?1:p,g=e.far,v=void 0===g?10:g,b=e.resolution,M=void 0===b?256:b,w=d.default(e,["opacity","width","height","blur","far","resolution"]),y=n.useThree((function(e){return e.scene})),T=n.useThree((function(e){return e.gl})),j=f.useRef(),x=f.useMemo((function(){var e=new c.WebGLRenderTarget(M,M),r=new c.WebGLRenderTarget(M,M);r.texture.generateMipmaps=e.texture.generateMipmaps=!1;var t=new c.PlaneBufferGeometry(o,h).rotateX(Math.PI/2),a=new c.Mesh(t),n=new c.MeshDepthMaterial;n.depthTest=n.depthWrite=!1,n.onBeforeCompile=function(e){return e.fragmentShader=e.fragmentShader.replace("1.0 - fragCoordZ ), opacity );","0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );")};var i=new c.ShaderMaterial(u.HorizontalBlurShader),l=new c.ShaderMaterial(u.VerticalBlurShader);return l.depthTest=i.depthTest=!1,[e,t,n,a,i,l,r]}),[M,o,h]),R=x[0],O=x[1],P=x[2],S=x[3],q=x[4],B=x[5],C=x[6];return n.useFrame((function(){if(j.current){var e=y.background;y.background=null,y.overrideMaterial=P,T.setRenderTarget(R),T.render(y,j.current),y.overrideMaterial=null,S.material=q,S.material.uniforms.tDiffuse.value=R.texture,q.uniforms.h.value=m/256,T.setRenderTarget(C),T.render(S,j.current),S.material=B,S.material.uniforms.tDiffuse.value=C.texture,B.uniforms.v.value=m/256,T.setRenderTarget(R),T.render(S,j.current),T.setRenderTarget(null),y.background=e}})),f.createElement("group",l.default({},w,{ref:r}),f.createElement("mesh",{geometry:O,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},f.createElement("meshBasicMaterial",{map:R.texture,transparent:!0,opacity:a})),f.createElement("orthographicCamera",{ref:j,args:[-o/2,o/2,h/2,-h/2,0,v]}))}));exports.ContactShadows=s;
