"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),t=require("react"),n=require("three"),a=require("@react-three/fiber"),i=require("../materials/SpotLightMaterial.cjs.js");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("@babel/runtime/helpers/inheritsLoose");var l=o(e),s=o(r),c=u(t),f=new n.Vector3,p=c.forwardRef((function(e,r){var t=e.depthBuffer,o=e.color,u=void 0===o?"white":o,p=e.distance,m=void 0===p?5:p,d=e.angle,h=void 0===d?.15:d,v=e.attenuation,g=void 0===v?5:v,b=e.anglePower,w=void 0===b?5:b,j=s.default(e,["depthBuffer","color","distance","angle","attenuation","anglePower"]),y=c.useRef(null),M=a.useThree((function(e){return e.size})),P=a.useThree((function(e){return e.camera})),q=a.useThree((function(e){return e.viewport.dpr})),x=c.useState((function(){return new i.SpotLightMaterial}))[0];a.useFrame((function(){x.uniforms.spotPosition.value.copy(y.current.getWorldPosition(f)),y.current.lookAt(y.current.parent.target.position)}));var O=c.useMemo((function(){var e=new n.CylinderGeometry(.1,7*h,m,128,64,!0);return e.applyMatrix4((new n.Matrix4).makeTranslation(0,-m/2,0)),e.applyMatrix4((new n.Matrix4).makeRotationX(-Math.PI/2)),e}),[h,m]);return c.createElement("spotLight",l.default({ref:r,angle:h,color:u,distance:m},j),c.createElement("mesh",{ref:y,geometry:O},c.createElement("primitive",{object:x,attach:"material","uniforms-lightColor-value":u,"uniforms-attenuation-value":g,"uniforms-anglePower-value":w,"uniforms-depth-value":t,"uniforms-cameraNear-value":P.near,"uniforms-cameraFar-value":P.far,"uniforms-resolution-value":t?[M.width*q,M.height*q]:[0,0]})))}));exports.SpotLight=p;
